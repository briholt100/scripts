table(df$job.cat[df$year==2014],df$Salary[df$year==2014])
tbl<-as.data.frame(table(df$Salary,df$year,df$Agency))
tbl
tbl<-as.data.frame(table(df$Salary,df$year,df$job.cat))
head(tbl)
colnames(tbl)<-c('Salary','year','job.cat','Freq')
library(ggplot)
library(ggplot2)
ggplot(y=Salary, data=tbl, aes(x=job.cat))+geom_line()
p<-ggplot(y=Salary, data=tbl, aes(x=job.cat))
p+geom_bar()
p+geom_points()
p+geom_point()
head(tbl)
plot(tbl$Salary~tbl$job.cat,type="l")
plot(tbl$Salary~tbl$job.cat,)
plot(tbl$Freq~tbl$job.cat)
p<-ggplot(y=Freq, data=tbl, aes(x=job.cat))
p+geom_bar()
?plot
plot(tbl$Freq~tbl$job.cat,type='h')
plot(tbl$Freq~tbl$job+tbl$year.cat,type='h')
qplot(tbl$Freq~tbl$job.cat,type='h')
qplot(tbl$Freq,tbl$job.cat,type='h')
qplot(y= Freq,x=job.cat,data=df)
qplot(y= Freq,x=job.cat,data=tbl)
qplot(y= Freq,x=job.cat,data=tbl,facets=year)
head(tbl)
qplot(y= Freq,x=job.cat,data=tbl,color=year)
p<-ggplot(y= Freq,x=job.cat,data=tbl,facets=year)
p+geom_line()
final_df<-read.csv( file = "./scripts/final_df.csv")
head(final_df_
head(final_df)
table(is.na(final_df$et))
table(is.na(final_df$et)==F)
table(is.na(final_df$et)==F,final_df$year)
table(final_df$et)
final_df[(final_df$et=='7S')],
final_df[(final_df$et=='7S'),]
final_df[final_df$et=='7S',]
table(final_df$et)
final_df[final_df$et=='7P',]
table(final_df$et)
table(final_df$et=='7P')
table(final_df$et=='7S')
which(final_df$et=='7S')
final_df[which(final_df$et=='7S'),]
final_df[which(final_df$et=='7P'),]
final_df[which(final_df$et=='6P'),]
final_df[which(final_df$Employee=='KELLY, HUGH J '& final_df$year=='2009'),]
final_df[which(final_df$Employee=='KELLY, HUGH J '& final_df$year=='2007'),]
final_df[which(final_df$Employee=='KELLY, HUGH J'& final_df$year=='2007'),]
final_df[which(final_df$Employee=='KELLY, HUGH J'),]
library(tidyr)
library(dplyr)
library(ggplot2)
library(rpart)
library(rpart.plot)
getwd()
colleges_df<-read.csv( file = "./scripts/colleges_df.csv")
colleges_df<-read.csv( file = "./scripts/colleges_df.csv")
colleges_df<-colleges_df[is.na(colleges_df$Salary)==F,2:8]
colleges_df<-colleges_df[colleges_df$year>2010,]
colleges_df$Code<-as.factor(colleges_df$Code)
colleges_df$year<-as.factor(colleges_df$year)
str(colleges_df)
colleges_df$Code<-relevel(colleges_df$Code,"670")
#colleges_df$year<-as.Date(paste(colleges_df$year,"-06","-30",sep=""))
colleges_df$Agency<-gsub("college|community|technical|for comm and tech coll","",colleges_df$Agency,ignore.case=T)
colleges_df$Agency<-gsub("  |   "," ",colleges_df$Agency,ignore.case=T)
colleges_df$Agency<-as.factor(colleges_df$Agency)
#
colleges_df$job.cat<-"other"
vicePres.list<-grep("vp|vice pres|v\\.p\\.|CHIEF INFORMATION OFFICER", colleges_df$Job.Title, ignore.case=T)
Chanc.list<-grep("v\\.c\\.|vice chan|vc|chancellor", colleges_df$Job.Title, ignore.case=T)
BOT.list<-grep("BOARD OF TRUST", colleges_df$Job.Title, ignore.case=T)
HR.list<-grep("hr|human resource", colleges_df$Job.Title, ignore.case=T)
mail.list<-grep("mail", colleges_df$Job.Title, ignore.case=T)
counselor.list<-grep("counselor", colleges_df$Job.Title, ignore.case=T)
advisor.list<-grep("registr|advisor|CREDENTIALS|EDUCATIONAL PLANNER", colleges_df$Job.Title, ignore.case=T)
library.list<-grep("libr", colleges_df$Job.Title, ignore.case=T)
retail.list<-grep("retail|book|cashier", colleges_df$Job.Title, ignore.case=T)
food.list<-grep("snack|cook|food|CATERING", colleges_df$Job.Title, ignore.case=T)
pres.list<-grep("president", colleges_df$Job.Title, ignore.case=T)
profTech.list<-grep("PROFESSIONAL TECHNICAL", colleges_df$Job.Title, ignore.case=T)
exempt.list<-grep("exempt|EXMT", colleges_df$Job.Title, ignore.case=T)
dean.list<-grep("dean|PROGRAM ADMINISTRATOR    .", colleges_df$Job.Title, ignore.case=T)
super.list<-grep("SUPERVISR|SUPERVISOR|SUPRV", colleges_df$Job.Title, ignore.case=T)
execAssist.list<-grep("SPEC\\. ASSISTANT|SPECIAL ASST TO|CONF ASST|CONFIDL SEC|ASSISTANT TO|EXECUTIVE ASSISTANT|EXECUTIVE ASST|EXEC\\. ASSISTANT|SPEC, ASST", colleges_df$Job.Title, ignore.case=T)
specialist.list<-grep("specialist|spec|CONSULT", colleges_df$Job.Title, ignore.case=T)
assist.list<-grep("COPY CENTER|OFFICE ASST|ADMINISTRATIVE ASST|assistant|ADMIN ASST", colleges_df$Job.Title, ignore.case=T)
facilities.list<-grep("LNDSCP|PAINTER|HEAVY EQUIPMENT|WAREHOUSE|custodian|mechanic|ELECTRICIAN|HEATING|utility worker|FACILITIES|grounds", colleges_df$Job.Title, ignore.case=T)
faculty.list<-grep("faculty|professor|moonlight|ftf |ptf |LECTURER|instructor", colleges_df$Job.Title, ignore.case=T)
progCoord.list<-grep("PROGRAM COORDINATOR|PROGRAM SUPPORT SUPV|COORD|COORDINATOR", colleges_df$Job.Title, ignore.case=T)
AdminTempAssign.list<-grep("ADMIN-TEMP. ASSIGNNMENT", colleges_df$Job.Title, ignore.case=T)
progAssist.list<-grep("PROGRAM ASSISTANT", colleges_df$Job.Title, ignore.case=T)
security.list<-grep("PUBLIC SFTY|security", colleges_df$Job.Title, ignore.case=T)
secretary.list<-grep("secretary", colleges_df$Job.Title, ignore.case=T)
manager.list<-grep("manager|MGR", colleges_df$Job.Title, ignore.case=T)
director.list<-grep("director|dir", colleges_df$Job.Title, ignore.case=T)
IT.list<-grep("SYSTEMS ADMINISTRATOR|IT TECHNICIAN|INFORMATION TECH SPEC|NETWORK|info tech|INFOR TECH TECHNICIAN", colleges_df$Job.Title, ignore.case=T)
childhood.list<-grep("childhood|child", colleges_df$Job.Title, ignore.case=T)
instrSupport.list<-grep("MEDIA TECHNICIAN|INSTR&CLASS SUP TECH|INSTRUCTIONAL PRGM ASST|INSTRUCTIONAL TECH|INSTR&CLASSROOM SUPT|INSTRUCTION & CLASSROOM SUPPORT|INSTR & CLASS SUPP|INSTRUCTIONAL TECHNICIAN", colleges_df$Job.Title, ignore.case=T)
fiscal.list<-grep("budget|fiscal|FINANCIAL|ACCOUNTANT|ANALYST", colleges_df$Job.Title, ignore.case=T)
colleges_df$job.cat<-factor(colleges_df$job.cat,
sort(c(
"assistant",
'Chancellor',
'boardTrust',
'library',
"vicePres",
'food',
"exempt",
"execAssist",
'dean',
"faculty",
"PROGRAM_COORD",
"AdminTempAssign",
"Program_Assist",
"facilities",
"security",
"secretary",
"manager",
'supervisor',
'director',
'it_depart',
'specialist',
'early_child',
'instruct_suppt',
'fiscal',
'profTech',
'president',
'retail',
'HR',
'mail',
'counselor',
'advisor',
"other"
)
))
##WARNING; BEWARE OF CHANGING ORDER BELOW, ELSE CATEGORIES WILL CHANGE
colleges_df$job.cat[pres.list]<-"president"
colleges_df$job.cat[vicePres.list]<-"vicePres"
colleges_df$job.cat[Chanc.list]<-"Chancellor"
colleges_df$job.cat[BOT.list]<-'boardTrust'
colleges_df$job.cat[HR.list]<-'HR'
colleges_df$job.cat[mail.list]<-"mail"
colleges_df$job.cat[counselor.list]<-"counselor"
colleges_df$job.cat[advisor.list]<-"advisor"
colleges_df$job.cat[advisor.list]<-"advisor"
colleges_df$job.cat[retail.list]<-"retail"
colleges_df$job.cat[library.list]<-"library"
colleges_df$job.cat[profTech.list]<-"profTech"
colleges_df$job.cat[food.list]<-"food"
colleges_df$job.cat[exempt.list]<-"exempt"
colleges_df$job.cat[specialist.list]<-"specialist"
colleges_df$job.cat[faculty.list]<-"faculty"
colleges_df$job.cat[progCoord.list]<-"PROGRAM_COORD"
colleges_df$job.cat[AdminTempAssign.list]<-"AdminTempAssign"
colleges_df$job.cat[progAssist.list]<-"Program_Assist"
colleges_df$job.cat[facilities.list]<-"facilities"
colleges_df$job.cat[security.list]<-"security"
colleges_df$job.cat[secretary.list]<-"secretary"
colleges_df$job.cat[manager.list]<-"manager"
colleges_df$job.cat[director.list]<-"director"
colleges_df$job.cat[IT.list]<-"it_depart"
colleges_df$job.cat[childhood.list]<-"early_child"
colleges_df$job.cat[instrSupport.list]<-"instruct_suppt"
colleges_df$job.cat[fiscal.list]<-"fiscal"
colleges_df$job.cat[super.list]<-"supervisor"
colleges_df$job.cat[assist.list]<-"assistant"
colleges_df$job.cat[execAssist.list]<-"execAssist"
colleges_df$job.cat[dean.list]<-"dean"
boxplot(colleges_df$Salary~colleges_df$job.cat)
?boxplot
boxplot(colleges_df$Salary~colleges_df$job.cat,las=2)
colleges_df$Job.Title[colleges_df$job.cat=="Chancellor"]
seattle<-colleges_df[grep("seattle",ignore.case=T,colleges_df$Agency),]
boxplot(seattle$Salary~seattle$job.cat,las=2)
seattle$Job.Title[seattle$job.cat=="Chancellor"]
seattlee[seattle$job.cat=="Chancellor",]
seattle[seattle$job.cat=="Chancellor",]
seattle[seattle$job.cat=="vicePres",]
seattle[seattle$job.cat=="dean",]
?trim
?geom_hist
?geom_bar
p<-ggplot(seattle, aes(x=year))
p+geom_bar()+facet_wrap(~job.cat)
p<-ggplot(seattle, aes(x=job.cat))
p+geom_bar()
p+geom_bar()+facet_wrap(~job.cat)
p<-ggplot(seattle, aes(x=Salary))
p+geom_bar()+facet_wrap(~job.cat)
p<-ggplot(seattle[seattle$job.cat!='faculty'], aes(x=Salary))
p<-ggplot(seattle[seattle$job.cat!='faculty',], aes(x=Salary))
p+geom_bar()+facet_wrap(~job.cat)
p<-ggplot(seattle[seattle$job.cat=='director',], aes(x=Salary))
p+geom_bar()
p+geom_bar(binwidth=20)
p<-ggplot(seattle[seattle$job.cat=='specialist',], aes(x=Salary))
p+geom_bar()
p<-ggplot(seattle[seattle$job.cat=='dean',], aes(x=Salary))
p+geom_bar()
p<-ggplot(seattle[seattle$job.cat=='AdminTempAssign',], aes(x=Salary))
p+geom_bar()
seattle[seattle$job.cat=='AdminTempAssign',]
p<-ggplot(seattle[seattle$job.cat=='assistant',], aes(x=Salary))
p+geom_bar()
p<-ggplot(seattle[seattle$job.cat=='HR',], aes(x=Salary))
p+geom_bar()
p<-ggplot(seattle[seattle$job.cat=='it_depart',], aes(x=Salary))
p+geom_bar()
p<-ggplot(seattle[seattle$job.cat=='manager',], aes(x=Salary))
p+geom_bar()
######
library(tidyr)
library(dplyr)
library(ggplot2)
library(rpart)
library(rpart.plot)
wrkdir<-'/home/brian/Projects/scripts'
setwd(wrkdir)
#
colleges_df$job.cat<-"other"
vicePres.list<-grep("PRINCIPAL,HIGH SCHOOL|COLLEGE INFORMATION OFFICR|VICE-PRES|vp|vice pres|v\\.p\\.", colleges_df$Job.Title, ignore.case=T)
Chanc.list<-grep("CEO FOR FOUNDATION|v\\.c\\.|vice chan|vc |chancellor|CHIEF|VICE PROV", colleges_df$Job.Title, ignore.case=T)
BOT.list<-grep("BOARD OF TRUST", colleges_df$Job.Title, ignore.case=T)
HR.list<-grep("HUMAN RESRCS|hr|human resource", colleges_df$Job.Title, ignore.case=T)
mail.list<-grep("mail", colleges_df$Job.Title, ignore.case=T)
counselor.list<-grep("counselor", colleges_df$Job.Title, ignore.case=T)
advisor.list<-grep("ENROLL SVC REG|career|ACAD ADVSR|INTERNATIONAL STUDNT ADVSR|ADMISSIONS ADV/RECRUITER|registr|advisor|CREDENTIALS|EDUCATIONAL PLANNER", colleges_df$Job.Title, ignore.case=T)
library.list<-grep("INTERIM CYBRARIAN|TECHNOLOGY TECHNICIAN LBRY|libr", colleges_df$Job.Title, ignore.case=T)
retail.list<-grep("retail|book|cashier", colleges_df$Job.Title, ignore.case=T)
food.list<-grep("baker helper|DISHWASHER|snack|cook|food|CATERING", colleges_df$Job.Title, ignore.case=T)
pres.list<-grep("president", colleges_df$Job.Title, ignore.case=T)
profTech.list<-grep("PROFESSIONAL TECHNICAL", colleges_df$Job.Title, ignore.case=T)
exempt.list<-grep("ATH MKTG|POLICY ASSOCIATE|GRANT WRITER|INSTITUTIONAL RESEARCHER|PAYROLL OFFICER|PAYROLL TECHNICIAN|POLICY RESEARCH|exempt|EXMT|controller", colleges_df$Job.Title, ignore.case=T)
dean.list<-grep("DATABASE/APP ADMINISTRATOR|DN |DIVISION CHAIRPERSON|dean|PROGRAM ADMIN", colleges_df$Job.Title, ignore.case=T)
super.list<-grep("SUPERVSR|OPR SUPV|SUPERVISR|SUPERVISOR|SUPRV", colleges_df$Job.Title, ignore.case=T)
execAssist.list<-grep("EXECT ASST|ADMIN ASSIST PRES OFFICE|EXEC ASSIST TO |ADMIN ASST-VICE|EXEC\\.+ ASST|EX AST|EXE ASST|ADM.ASST. VP|EXEC ASST|EXECUTIVE ASSIST|ADM. ASST|EXEC ADM ASSIST|SPEC\\. ASSISTANT|SPECIAL ASST TO|CONF ASST|CONFIDL SEC|ASSISTANT TO|EXECUTIVE ASSISTANT|EXECUTIVE ASST|EXEC\\. ASSISTANT|SPEC, ASST", colleges_df$Job.Title, ignore.case=T)
specialist.list<-grep("FACILITATOR|ATH FUNDRSR INTR/RODEO|SPC|specialist|spec|CONSULT", colleges_df$Job.Title, ignore.case=T)
assist.list<-grep("VETERANS AFFAIR/FA ASSIST|STU SVC OFC ASST/TEST PCTR|AEROSPACE GRANTS PROG ASST|RECEPTIONIST|OFFSET PRINTER OPERATOR|EXTRA HELP CLASSIFIED|SUPPORT STAFF|COPY CENTER|OFFICE ASST|ADMINISTRATIVE ASST|assistant|ADMIN ASST", colleges_df$Job.Title, ignore.case=T)
facilities.list<-grep("CONSTR& MAINT PROJ LEAD|TOOL ROOM ATTENDANT|ELECTRONICS TECHNICIAN|BUILDING MAIN LEAD|MAINTAINANCE|MAINTENANCE|CUSTODIAL ENGINEER B|CUSTODIAL|BUILDING ENGINEER|GENERAL LABORER|CARPENTER|MAINTENANCE ENGINEER|LNDSCP|PAINTER|HEAVY EQUIPMENT|WAREHOUSE|custodian|mechanic|ELECTRICIAN|HEATING|utility worker|FACILITIES|grounds", colleges_df$Job.Title, ignore.case=T)
faculty.list<-grep("ENOLOGY INSTR/WINEMAKER|FTF-TENURE|faculty|professor|moonlight|ftf |ptf |LECTURER|instructor", colleges_df$Job.Title, ignore.case=T)
Coord.list<-grep("COOR,WORKER RETRAINING|PROGRAM SUPPORT SUPV|COOR|DOL GRANT PROJECT CORD|COORDINATOR", colleges_df$Job.Title, ignore.case=T)
progCoord.list<-grep("PROGRAM COORDINATOR", colleges_df$Job.Title, ignore.case=T)
AdminTempAssign.list<-grep("ADMIN-TEMP. ASSIGNNMENT", colleges_df$Job.Title, ignore.case=T)
security.list<-grep("SAFETY OFFICER|parking|PUBLIC SFTY|security", colleges_df$Job.Title, ignore.case=T)
secretary.list<-grep("ADMINISTRATIVE ASSIST|secretary", colleges_df$Job.Title, ignore.case=T)
manager.list<-grep("MAGR|MNGR|ADMIN SERVICE ADMINISTRATR|PROGRAM DEVELOPER|manager|MGR", colleges_df$Job.Title, ignore.case=T)
director.list<-grep("PUBLIC INFORMATION OFFICER|director|dir", colleges_df$Job.Title, ignore.case=T)
IT.list<-grep("SYSTEM ADMINISTRATOR|SOFTWARE QA ENGINEER|SENIOR SYSTEMS INTEGRATOR|SYSTEMS ARCHITECT|INSTR SERVER ADMINISTRATOR|DATA CLERK|DATABASE/WEB APP PROGRAMME|DATABASE ADMINISTRATOR|COMPUTER&NETWRK |COMPUTER SUPPORT TECH|LEAD SYSTEMS ENGINEER|IT COMPUTER OPERATOR LEAD|DEVELOPER-IT|WEB PROG/DATABASE ADMIN|WEB DESIGNER|SHARPOINT ADMINIST/DEVELOP|SR DATABASE ADMINISTRATOR|INFORMATIONAL TECH|INFOR TECH COMP OPERATOR|APPLICATION DEVELOP|IT - COMPUTER OPERATOR|HELP DESK TECHNICIAN|SOFTWARE ENGINEER|COMPUTER&NETWRK SUPRT TECH|DEVELOPER - SOFTWARE|COMPUTER MAIN TECH|IT DATA PROCESSOR|COMPUTER SYSTEM TECHNICIAN|IT - COMPUTER OPER LEAD|DATA COMPILER|webmaster|COMPUTER PROGRAMMER|IT TECH|IT SPECIAL|EQUIPMENT TECHNICIAN|CMPUTR/NETWRK MAINT TECH|SYSTEMS ADMINISTRATOR|IT TECHNICIAN|INFORMATION TECH SPEC|NETWORK|info tech|INFOR TECH TECHNICIAN", colleges_df$Job.Title, ignore.case=T)
childhood.list<-grep(" IT COMPUTER OPERATOR|EDUCATION PL/RETENTION |PARENT MENTOR|childhood|child", colleges_df$Job.Title, ignore.case=T)
instrSupport.list<-grep("INST&CLASSRM SUPPT TECH|INSTR%CLASSROON SUPT TCH4|INSTRUCT TECH|INSTR & CLASSRM SUPP|INSTRUCTIONAL SUPPORT|INSTRUCTIONAL ASST|INST & CLASS SUP|INST & CLASS SUP|INSTR&CLASS SUPP TECH1|INSTR & CLASSRM SUPP TECH2|LAB TECH|INSTR/CLASS SUPP TECH|LABORATORY TECHNICIAN|INSTR&CLASS SUP TECH|INSTRUCTIONAL PRGM ASST|INSTRUCTIONAL TECH|INSTR&CLASSROOM SUPT|INSTRUCTION & CLASSROOM SUPPORT|INSTR & CLASS SUPP|INSTRUCTIONAL TECHNICIAN", colleges_df$Job.Title, ignore.case=T)
fiscal.list<-grep("FMS/PPMS|ACCOUNTING|INTERNAL AUDITOR|ACCOUNTS PAYABLE|budget|fiscal|FINANCIAL|ACCOUNTANT|ANALYST", colleges_df$Job.Title, ignore.case=T)
media.list<-grep("DIGITAL PRINTING|PRINTER-LITHOGRAPHER|media|graphic", colleges_df$Job.Title, ignore.case=T)
coach.list<-grep("ATHLETIC|coach", colleges_df$Job.Title, ignore.case=T)
colleges_df$job.cat<-factor(colleges_df$job.cat,
sort(c(
"assistant",
"media",
'Chancellor',
"coach",
'boardTrust',
'library',
"vicePres",
'food',
"exempt",
"execAssist",
'dean',
"faculty",
"Program_Coord",
"Coordinator",
"AdminTempAssign",
"Program_Assist",
"facilities",
"security",
"secretary",
"manager",
'supervisor',
'director',
'it_depart',
'specialist',
'early_child',
'instruct_suppt',
'fiscal',
'profTech',
'president',
'retail',
'HR',
'mail',
'counselor',
'advisor',
"other"
)
))
##WARNING; BEWARE OF CHANGING ORDER BELOW, ELSE CATEGORIES WILL CHANGE
colleges_df$job.cat[pres.list]<-"president"
colleges_df$job.cat[Chanc.list]<-"Chancellor"
colleges_df$job.cat[BOT.list]<-'boardTrust'
colleges_df$job.cat[HR.list]<-'HR'
colleges_df$job.cat[vicePres.list]<-"vicePres"
colleges_df$job.cat[media.list]<-'media'
colleges_df$job.cat[mail.list]<-"mail"
colleges_df$job.cat[counselor.list]<-"counselor"
colleges_df$job.cat[advisor.list]<-"advisor"
colleges_df$job.cat[advisor.list]<-"advisor"
colleges_df$job.cat[retail.list]<-"retail"
colleges_df$job.cat[library.list]<-"library"
colleges_df$job.cat[profTech.list]<-"profTech"
colleges_df$job.cat[food.list]<-"food"
colleges_df$job.cat[exempt.list]<-"exempt"
colleges_df$job.cat[specialist.list]<-"specialist"
colleges_df$job.cat[faculty.list]<-"faculty"
colleges_df$job.cat[Coord.list]<- "Coordinator"
colleges_df$job.cat[progCoord.list]<-"Program_Coord"
colleges_df$job.cat[AdminTempAssign.list]<-"AdminTempAssign"
colleges_df$job.cat[coach.list]<-"coach"
colleges_df$job.cat[facilities.list]<-"facilities"
colleges_df$job.cat[security.list]<-"security"
colleges_df$job.cat[secretary.list]<-"secretary"
colleges_df$job.cat[manager.list]<-"manager"
colleges_df$job.cat[director.list]<-"director"
colleges_df$job.cat[IT.list]<-"it_depart"
colleges_df$job.cat[childhood.list]<-"early_child"
colleges_df$job.cat[instrSupport.list]<-"instruct_suppt"
colleges_df$job.cat[fiscal.list]<-"fiscal"
colleges_df$job.cat[super.list]<-"supervisor"
colleges_df$job.cat[assist.list]<-"assistant"
colleges_df$job.cat[execAssist.list]<-"execAssist"
colleges_df$job.cat[dean.list]<-"dean"
getwd()
colleges_df<-read.csv( file = ".
/colleges_df.csv")
colleges_df<-read.csv( file = "./Data/colleges_df.csv")
colleges_df<-read.csv( file = "
./
colleges_df.csv")
colleges_df<-read.csv( file = "./Data/colleges_df.csv")
colleges_df<-read.csv( file = "./colleges_df.csv")
colleges_df<-colleges_df[is.na(colleges_df$Salary)==F,2:8]
#colleges_df<-colleges_df[colleges_df$year>2010,]
colleges_df$Code<-as.factor(colleges_df$Code)
colleges_df$year<-as.factor(colleges_df$year)
str(colleges_df)
colleges_df$Code<-relevel(colleges_df$Code,"670")
#colleges_df$year<-as.Date(paste(colleges_df$year,"-06","-30",sep=""))
colleges_df$Agency<-gsub("college|community|technical|for comm and tech coll","",colleges_df$Agency,ignore.case=T)
colleges_df$Agency<-gsub("  |   "," ",colleges_df$Agency,ignore.case=T)
colleges_df$Agency<-as.factor(colleges_df$Agency)
#
colleges_df$job.cat<-"other"
vicePres.list<-grep("PRINCIPAL,HIGH SCHOOL|COLLEGE INFORMATION OFFICR|VICE-PRES|vp|vice pres|v\\.p\\.", colleges_df$Job.Title, ignore.case=T)
Chanc.list<-grep("CEO FOR FOUNDATION|v\\.c\\.|vice chan|vc |chancellor|CHIEF|VICE PROV", colleges_df$Job.Title, ignore.case=T)
BOT.list<-grep("BOARD OF TRUST", colleges_df$Job.Title, ignore.case=T)
HR.list<-grep("HUMAN RESRCS|hr|human resource", colleges_df$Job.Title, ignore.case=T)
mail.list<-grep("mail", colleges_df$Job.Title, ignore.case=T)
counselor.list<-grep("counselor", colleges_df$Job.Title, ignore.case=T)
advisor.list<-grep("ENROLL SVC REG|career|ACAD ADVSR|INTERNATIONAL STUDNT ADVSR|ADMISSIONS ADV/RECRUITER|registr|advisor|CREDENTIALS|EDUCATIONAL PLANNER", colleges_df$Job.Title, ignore.case=T)
library.list<-grep("INTERIM CYBRARIAN|TECHNOLOGY TECHNICIAN LBRY|libr", colleges_df$Job.Title, ignore.case=T)
retail.list<-grep("retail|book|cashier", colleges_df$Job.Title, ignore.case=T)
food.list<-grep("baker helper|DISHWASHER|snack|cook|food|CATERING", colleges_df$Job.Title, ignore.case=T)
pres.list<-grep("president", colleges_df$Job.Title, ignore.case=T)
profTech.list<-grep("PROFESSIONAL TECHNICAL", colleges_df$Job.Title, ignore.case=T)
exempt.list<-grep("ATH MKTG|POLICY ASSOCIATE|GRANT WRITER|INSTITUTIONAL RESEARCHER|PAYROLL OFFICER|PAYROLL TECHNICIAN|POLICY RESEARCH|exempt|EXMT|controller", colleges_df$Job.Title, ignore.case=T)
dean.list<-grep("DATABASE/APP ADMINISTRATOR|DN |DIVISION CHAIRPERSON|dean|PROGRAM ADMIN", colleges_df$Job.Title, ignore.case=T)
super.list<-grep("SUPERVSR|OPR SUPV|SUPERVISR|SUPERVISOR|SUPRV", colleges_df$Job.Title, ignore.case=T)
execAssist.list<-grep("EXECT ASST|ADMIN ASSIST PRES OFFICE|EXEC ASSIST TO |ADMIN ASST-VICE|EXEC\\.+ ASST|EX AST|EXE ASST|ADM.ASST. VP|EXEC ASST|EXECUTIVE ASSIST|ADM. ASST|EXEC ADM ASSIST|SPEC\\. ASSISTANT|SPECIAL ASST TO|CONF ASST|CONFIDL SEC|ASSISTANT TO|EXECUTIVE ASSISTANT|EXECUTIVE ASST|EXEC\\. ASSISTANT|SPEC, ASST", colleges_df$Job.Title, ignore.case=T)
specialist.list<-grep("FACILITATOR|ATH FUNDRSR INTR/RODEO|SPC|specialist|spec|CONSULT", colleges_df$Job.Title, ignore.case=T)
assist.list<-grep("VETERANS AFFAIR/FA ASSIST|STU SVC OFC ASST/TEST PCTR|AEROSPACE GRANTS PROG ASST|RECEPTIONIST|OFFSET PRINTER OPERATOR|EXTRA HELP CLASSIFIED|SUPPORT STAFF|COPY CENTER|OFFICE ASST|ADMINISTRATIVE ASST|assistant|ADMIN ASST", colleges_df$Job.Title, ignore.case=T)
facilities.list<-grep("CONSTR& MAINT PROJ LEAD|TOOL ROOM ATTENDANT|ELECTRONICS TECHNICIAN|BUILDING MAIN LEAD|MAINTAINANCE|MAINTENANCE|CUSTODIAL ENGINEER B|CUSTODIAL|BUILDING ENGINEER|GENERAL LABORER|CARPENTER|MAINTENANCE ENGINEER|LNDSCP|PAINTER|HEAVY EQUIPMENT|WAREHOUSE|custodian|mechanic|ELECTRICIAN|HEATING|utility worker|FACILITIES|grounds", colleges_df$Job.Title, ignore.case=T)
faculty.list<-grep("ENOLOGY INSTR/WINEMAKER|FTF-TENURE|faculty|professor|moonlight|ftf |ptf |LECTURER|instructor", colleges_df$Job.Title, ignore.case=T)
Coord.list<-grep("COOR,WORKER RETRAINING|PROGRAM SUPPORT SUPV|COOR|DOL GRANT PROJECT CORD|COORDINATOR", colleges_df$Job.Title, ignore.case=T)
progCoord.list<-grep("PROGRAM COORDINATOR", colleges_df$Job.Title, ignore.case=T)
AdminTempAssign.list<-grep("ADMIN-TEMP. ASSIGNNMENT", colleges_df$Job.Title, ignore.case=T)
security.list<-grep("SAFETY OFFICER|parking|PUBLIC SFTY|security", colleges_df$Job.Title, ignore.case=T)
secretary.list<-grep("ADMINISTRATIVE ASSIST|secretary", colleges_df$Job.Title, ignore.case=T)
manager.list<-grep("MAGR|MNGR|ADMIN SERVICE ADMINISTRATR|PROGRAM DEVELOPER|manager|MGR", colleges_df$Job.Title, ignore.case=T)
director.list<-grep("PUBLIC INFORMATION OFFICER|director|dir", colleges_df$Job.Title, ignore.case=T)
IT.list<-grep("SYSTEM ADMINISTRATOR|SOFTWARE QA ENGINEER|SENIOR SYSTEMS INTEGRATOR|SYSTEMS ARCHITECT|INSTR SERVER ADMINISTRATOR|DATA CLERK|DATABASE/WEB APP PROGRAMME|DATABASE ADMINISTRATOR|COMPUTER&NETWRK |COMPUTER SUPPORT TECH|LEAD SYSTEMS ENGINEER|IT COMPUTER OPERATOR LEAD|DEVELOPER-IT|WEB PROG/DATABASE ADMIN|WEB DESIGNER|SHARPOINT ADMINIST/DEVELOP|SR DATABASE ADMINISTRATOR|INFORMATIONAL TECH|INFOR TECH COMP OPERATOR|APPLICATION DEVELOP|IT - COMPUTER OPERATOR|HELP DESK TECHNICIAN|SOFTWARE ENGINEER|COMPUTER&NETWRK SUPRT TECH|DEVELOPER - SOFTWARE|COMPUTER MAIN TECH|IT DATA PROCESSOR|COMPUTER SYSTEM TECHNICIAN|IT - COMPUTER OPER LEAD|DATA COMPILER|webmaster|COMPUTER PROGRAMMER|IT TECH|IT SPECIAL|EQUIPMENT TECHNICIAN|CMPUTR/NETWRK MAINT TECH|SYSTEMS ADMINISTRATOR|IT TECHNICIAN|INFORMATION TECH SPEC|NETWORK|info tech|INFOR TECH TECHNICIAN", colleges_df$Job.Title, ignore.case=T)
childhood.list<-grep(" IT COMPUTER OPERATOR|EDUCATION PL/RETENTION |PARENT MENTOR|childhood|child", colleges_df$Job.Title, ignore.case=T)
instrSupport.list<-grep("INST&CLASSRM SUPPT TECH|INSTR%CLASSROON SUPT TCH4|INSTRUCT TECH|INSTR & CLASSRM SUPP|INSTRUCTIONAL SUPPORT|INSTRUCTIONAL ASST|INST & CLASS SUP|INST & CLASS SUP|INSTR&CLASS SUPP TECH1|INSTR & CLASSRM SUPP TECH2|LAB TECH|INSTR/CLASS SUPP TECH|LABORATORY TECHNICIAN|INSTR&CLASS SUP TECH|INSTRUCTIONAL PRGM ASST|INSTRUCTIONAL TECH|INSTR&CLASSROOM SUPT|INSTRUCTION & CLASSROOM SUPPORT|INSTR & CLASS SUPP|INSTRUCTIONAL TECHNICIAN", colleges_df$Job.Title, ignore.case=T)
fiscal.list<-grep("FMS/PPMS|ACCOUNTING|INTERNAL AUDITOR|ACCOUNTS PAYABLE|budget|fiscal|FINANCIAL|ACCOUNTANT|ANALYST", colleges_df$Job.Title, ignore.case=T)
media.list<-grep("DIGITAL PRINTING|PRINTER-LITHOGRAPHER|media|graphic", colleges_df$Job.Title, ignore.case=T)
coach.list<-grep("ATHLETIC|coach", colleges_df$Job.Title, ignore.case=T)
colleges_df$job.cat<-factor(colleges_df$job.cat,
sort(c(
"assistant",
"media",
'Chancellor',
"coach",
'boardTrust',
'library',
"vicePres",
'food',
"exempt",
"execAssist",
'dean',
"faculty",
"Program_Coord",
"Coordinator",
"AdminTempAssign",
"Program_Assist",
"facilities",
"security",
"secretary",
"manager",
'supervisor',
'director',
'it_depart',
'specialist',
'early_child',
'instruct_suppt',
'fiscal',
'profTech',
'president',
'retail',
'HR',
'mail',
'counselor',
'advisor',
"other"
)
))
##WARNING; BEWARE OF CHANGING ORDER BELOW, ELSE CATEGORIES WILL CHANGE
colleges_df$job.cat[pres.list]<-"president"
colleges_df$job.cat[Chanc.list]<-"Chancellor"
colleges_df$job.cat[BOT.list]<-'boardTrust'
colleges_df$job.cat[HR.list]<-'HR'
colleges_df$job.cat[vicePres.list]<-"vicePres"
colleges_df$job.cat[media.list]<-'media'
colleges_df$job.cat[mail.list]<-"mail"
colleges_df$job.cat[counselor.list]<-"counselor"
colleges_df$job.cat[advisor.list]<-"advisor"
colleges_df$job.cat[advisor.list]<-"advisor"
colleges_df$job.cat[retail.list]<-"retail"
colleges_df$job.cat[library.list]<-"library"
colleges_df$job.cat[profTech.list]<-"profTech"
colleges_df$job.cat[food.list]<-"food"
colleges_df$job.cat[exempt.list]<-"exempt"
colleges_df$job.cat[specialist.list]<-"specialist"
colleges_df$job.cat[faculty.list]<-"faculty"
colleges_df$job.cat[Coord.list]<- "Coordinator"
colleges_df$job.cat[progCoord.list]<-"Program_Coord"
colleges_df$job.cat[AdminTempAssign.list]<-"AdminTempAssign"
colleges_df$job.cat[coach.list]<-"coach"
colleges_df$job.cat[facilities.list]<-"facilities"
colleges_df$job.cat[security.list]<-"security"
colleges_df$job.cat[secretary.list]<-"secretary"
colleges_df$job.cat[manager.list]<-"manager"
colleges_df$job.cat[director.list]<-"director"
colleges_df$job.cat[IT.list]<-"it_depart"
colleges_df$job.cat[childhood.list]<-"early_child"
colleges_df$job.cat[instrSupport.list]<-"instruct_suppt"
colleges_df$job.cat[fiscal.list]<-"fiscal"
colleges_df$job.cat[super.list]<-"supervisor"
colleges_df$job.cat[assist.list]<-"assistant"
colleges_df$job.cat[execAssist.list]<-"execAssist"
colleges_df$job.cat[dean.list]<-"dean"
forPlot<-colleges_df %>%
group_by(Agency,job.cat,year) %>%
summarise(N=n(),Mean=mean(Salary,na.rm=T),Median=median(Salary,na.rm=T),SalaryTotal=sum(Salary,na.rm=T)) %>%
arrange(desc(N))
boxplot(forPlot$N~forPlot$job.cat, las=2,main="Number of Employees by Job category,\n across state 2010-2104")
boxplot(forPlot$Median~forPlot$job.cat, las=2,main="Median Salary by Job category,\n across state 2010-2104")
boxplot(forPlot$Mean~forPlot$job.cat, las=2,main="Mean Salary by Job category,\n across state 2010-2104")
boxplot(forPlot$SalaryTotal~forPlot$job.cat, las=2,main="Sum of all Salaries by Job category,\n across state 2010-2104")
p<-ggplot(forPlot, aes(y=Mean,x=Agency))
p+geom_boxplot()+theme(axis.text.x = element_text(angle = 90, hjust = 1))+
ggtitle("boxplots of Mean Salaries in State, \n2011-2014")
p<-ggplot(forPlot, aes(y=N,x=Agency))
p+geom_point(aes(color=Agency))+
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
facet_wrap(~year,ncol=4)+
ggtitle("Count of employees in State, \n2011-2014")
seattle<-colleges_df[grep("seattle",ignore.case=T,colleges_df$Agency),]
tapply(colleges_df$Salary,list(colleges_df$Agency,colleges_df$year),sum)
p<-ggplot(seattle[seattle$job.cat=="faculty",], aes(year))
p+geom_bar()+
#  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
facet_wrap(~job.cat)+
ggtitle("Count of facutly \nin Seattle, \n2011-2014")
p<-ggplot(seattle[seattle$job.cat!="faculty",], aes(year))
p+geom_bar()+
#  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
facet_wrap(~job.cat)+
ggtitle("Count of nonfacutly \nin Seattle, \n2011-2014")
tmp<-tmp[which( tmp$job.cat=='manager'|tmp$job.cat=='dean'|tmp$job.cat=='specialist'|tmp$job.cat=='director'|tmp$job.cat=='Coordinator'),]
tmp<-colleges_df[which(colleges_df$Agency == 'Seattle '),]
tmp<-tmp[which( tmp$job.cat=='manager'|tmp$job.cat=='dean'|tmp$job.cat=='specialist'|tmp$job.cat=='director'|tmp$job.cat=='Coordinator'),]
tmp$Job.Title<-droplevels(tmp$Job.Title)
tmp$job.cat<-droplevels(tmp$job.cat)
tapply(tmp$Salary,tmp$job.cat,length)
table(tmp$job.cat,tmp$year)
plot(tapply(tbl$Freq,tbl$year,sum),)
barplot(table(tmp$job.cat,tmp$year),main='managers, sepcialists, deans, directors',legend = rownames(table(tmp$job.cat,tmp$year)))
dt<-seattle%>%gather(year,Salary,-job.cat,-Job.Title,-Employee,-Agency,-Code,na.rm=T)
#dt<-seattle%>%gather(Time,Salary.Diff,T1,T2,T3,-job.cat,-Job.Title,-Employee,-Agency,-Code,na.rm=T)
dt$year<-as.character(dt$year)   #converting to date
dt$year<-gsub('X','',dt$year)
dt$year<-as.Date(dt$year,'%Y')
dt$year<-str_extract(dt$year, "[0-9]{4}")
#dt<-dean.salary%>%gather(year,Salary,-job.cat,-Job.Title,-Employee,-Agency,-Code,na.rm=T)
dt$year[dt$year=='X2011']<-as.Date
p<-ggplot(dt,aes(x=year,y=Salary))
p+geom_boxplot(notch=F)+
ggtitle("Boxplot of Salaries for jobs category with 'Dean' in the title
since 2011 in the Seattle District\n\nThis includes Associate Deans, Executive Deans, etc")
p<-ggplot(dt,aes(x=reorder(job.cat,Salary,FUN=median), y=Salary,group=job.cat))
p+geom_boxplot()+theme(axis.text.x = element_text(angle = 90, hjust = 1))+facet_wrap(~year)
